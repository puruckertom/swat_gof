##########################
#Little River
pdf(paste(source_dir,"figure_percentiles_lr.pdf",sep=""),height=8.5,width=6)
  par(mfrow=c(3,4),mai=c(0.8976/10,0.05,0.7216/4,0.05),mgp=c(2.25,1,0),oma=c(0,3,1.8,0))
  ymax.95 <- max(calib.95th.percentiles[,2],valid.95th.percentiles[,2],calib.95th.percentiles[,4],valid.95th.percentiles[,4],
                 calib.95th.percentiles[,6],valid.95th.percentiles[,6],calib.95th.percentiles[,8],valid.95th.percentiles[,8])
  ymin.95 <- min(calib.95th.percentiles[,2],valid.95th.percentiles[,2],calib.95th.percentiles[,4],valid.95th.percentiles[,4],
                 calib.95th.percentiles[,6],valid.95th.percentiles[,6],calib.95th.percentiles[,8],valid.95th.percentiles[,8])
  boxplot(cbind(calib.95th.percentiles[,2],valid.95th.percentiles[,2]),ylim=c(ymin.95,ymax.95),xaxt="n",col=c("gold","steelblue3"))
    title("CL")
    lines(c(0.5,1.5),c(calib.lr.obs.95,calib.lr.obs.95),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.95,valid.lr.obs.95),col="red",lwd=3,lend=1)
    points(1,calib.lr.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrCL_C[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrCL_V[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    axis(2,at=6,labels="95th Percentiles",outer=TRUE,padj=-1.2)
    title(main="Little River: Simulated Flow Percentile Distributions",outer=TRUE,cex=1.6)
    par(mai=c(0.8976/10,0.05,0.7216/4,0.05))
  boxplot(cbind(calib.95th.percentiles[,4],valid.95th.percentiles[,4]),ylim=c(ymin.95,ymax.95),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    title("NSE")
    lines(c(0.5,1.5),c(calib.lr.obs.95,calib.lr.obs.95),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.95,valid.lr.obs.95),col="red",lwd=3,lend=1)
    points(1,calib.lr.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrNS1_C[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrNS1_V[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
  boxplot(cbind(calib.95th.percentiles[,6],valid.95th.percentiles[,6]),ylim=c(ymin.95,ymax.95),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    title("MNS")
    lines(c(0.5,1.5),c(calib.lr.obs.95,calib.lr.obs.95),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.95,valid.lr.obs.95),col="red",lwd=3,lend=1)  
    points(1,calib.lr.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrMNS_C[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrMNS_V[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
  boxplot(cbind(calib.95th.percentiles[,8],valid.95th.percentiles[,8]),ylim=c(ymin.95,ymax.95),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    title("RSD")
    lines(c(0.5,1.5),c(calib.lr.obs.95,calib.lr.obs.95),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.95,valid.lr.obs.95),col="red",lwd=3,lend=1)
    points(1,calib.lr.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrRSD_C[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrRSD_V[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
  par(mai=c(0.8976/10,0.05,0.7216/10,0.05))
  ymax.50 <- max(calib.50th.percentiles[,2],valid.50th.percentiles[,2],calib.50th.percentiles[,4],valid.50th.percentiles[,4],
                 calib.50th.percentiles[,6],valid.50th.percentiles[,6],calib.50th.percentiles[,8],valid.50th.percentiles[,8])
  ymax.50 <- 1.0 #artificially lowered
  ymin.50 <- min(calib.50th.percentiles[,2],valid.50th.percentiles[,2],calib.50th.percentiles[,4],valid.50th.percentiles[,4],
                 calib.50th.percentiles[,6],valid.50th.percentiles[,6],calib.50th.percentiles[,8],valid.50th.percentiles[,8])
  boxplot(cbind(calib.50th.percentiles[,2],valid.50th.percentiles[,2]),ylim=c(ymin.50,ymax.50),ylab="50th Percentiles",xaxt="n",col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.lr.obs.50,calib.lr.obs.50),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.50,valid.lr.obs.50),col="red",lwd=3,lend=1)
    points(1,calib.lr.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrCL_C[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrCL_V[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    axis(2,at=0.5,labels="50th Percentiles",outer=TRUE,padj=-1.2)
    par(mai=c(0.8976/10,0.05,0.7216/10,0.05))
  boxplot(cbind(calib.50th.percentiles[,4],valid.50th.percentiles[,4]),ylim=c(ymin.50,ymax.50),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.lr.obs.50,calib.lr.obs.50),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.50,valid.lr.obs.50),col="red",lwd=3,lend=1)
    points(1,calib.lr.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrNS1_C[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrNS1_V[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
  boxplot(cbind(calib.50th.percentiles[,6],valid.50th.percentiles[,6]),ylim=c(ymin.50,ymax.50),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.lr.obs.50,calib.lr.obs.50),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.50,valid.lr.obs.50),col="red",lwd=3,lend=1)  
    points(1,calib.lr.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrMNS_C[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrMNS_V[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
  boxplot(cbind(calib.50th.percentiles[,8],valid.50th.percentiles[,8]),ylim=c(ymin.50,ymax.50),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.lr.obs.50,calib.lr.obs.50),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.50,valid.lr.obs.50),col="red",lwd=3,lend=1)
    points(1,calib.lr.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrRSD_C[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrRSD_V[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
  par(mai=c(0.8976/3,0.05,0.7216/10,0.05))
  ymax.5 <- max(calib.5th.percentiles[,2],valid.5th.percentiles[,2],calib.5th.percentiles[,4],valid.5th.percentiles[,4],
                 calib.5th.percentiles[,6],valid.5th.percentiles[,6],calib.5th.percentiles[,8],valid.5th.percentiles[,8])
  ymax.5 <- 0.07 #artificially lowered
  ymin.5 <- min(calib.5th.percentiles[,2],valid.5th.percentiles[,2],calib.5th.percentiles[,4],valid.5th.percentiles[,4],
                 calib.5th.percentiles[,6],valid.5th.percentiles[,6],calib.5th.percentiles[,8],valid.5th.percentiles[,8])
  boxplot(cbind(calib.5th.percentiles[,2],valid.5th.percentiles[,2]),ylim=c(ymin.5,ymax.5),ylab="5th Percentiles",names=c("C","V"),col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.lr.obs.5,calib.lr.obs.5),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.5,valid.lr.obs.5),col="red",lwd=3,lend=1)  
    points(1,calib.lr.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrCL_C[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrCL_V[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    axis(2,at=0.035,labels="5th Percentiles",outer=TRUE,padj=-1.2)
    par(mai=c(0.8976/3,0.05,0.7216/10,0.05))
  boxplot(cbind(calib.5th.percentiles[,4],valid.5th.percentiles[,4]),ylim=c(ymin.5,ymax.5),yaxt="n",names=c("C","V"),col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.lr.obs.5,calib.lr.obs.5),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.5,valid.lr.obs.5),col="red",lwd=3,lend=1)
    points(1,calib.lr.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrNS1_C[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrNS1_V[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    legend(.425,0.074,c("Observed","Best Run"),pch=c(1,4),col=c("red","darkgreen"),lty=c(1,0),lwd=c(2,2),cex=1.1,border="white")
  boxplot(cbind(calib.5th.percentiles[,6],valid.5th.percentiles[,6]),ylim=c(ymin.5,ymax.5),yaxt="n",names=c("C","V"),col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.lr.obs.5,calib.lr.obs.5),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.5,valid.lr.obs.5),col="red",lwd=3,lend=1)
    points(1,calib.lr.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrMNS_C[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrMNS_V[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
  boxplot(cbind(calib.5th.percentiles[,8],valid.5th.percentiles[,8]),ylim=c(ymin.5,ymax.5),yaxt="n",names=c("C","V"),col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.lr.obs.5,calib.lr.obs.5),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.lr.obs.5,valid.lr.obs.5),col="red",lwd=3,lend=1)
    points(1,calib.lr.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.lr.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$lrRSD_C[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$lrRSD_V[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
dev.off()
