##########################
#Mountain Creek
pdf(paste(source_dir,"figure_percentiles_mc.pdf",sep=""),height=8.5,width=6)
  par(mfrow=c(3,4),mai=c(0.8976/10,0.05,0.7216/4,0.05),mgp=c(2.25,1,0),oma=c(0,3,1.8,0))
  ymax.95 <- max(calib.95th.percentiles[,1],valid.95th.percentiles[,1],calib.95th.percentiles[,3],valid.95th.percentiles[,3],
                 calib.95th.percentiles[,5],valid.95th.percentiles[,5],calib.95th.percentiles[,7],valid.95th.percentiles[,7])
  ymin.95 <- min(calib.95th.percentiles[,1],valid.95th.percentiles[,1],calib.95th.percentiles[,3],valid.95th.percentiles[,3],
                 calib.95th.percentiles[,5],valid.95th.percentiles[,5],calib.95th.percentiles[,7],valid.95th.percentiles[,7])
  boxplot(cbind(calib.95th.percentiles[,1],valid.95th.percentiles[,1]),ylim=c(ymin.95,ymax.95),xaxt="n",col=c("gold","steelblue3"))
    title("CL")
    lines(c(0.5,1.5),c(calib.mc.obs.95,calib.mc.obs.95),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.95,valid.mc.obs.95),col="red",lwd=3,lend=1)
    points(1,calib.mc.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcCL_C[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcCL_V[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    axis(2,at=0.6,labels="95th Percentiles",outer=TRUE,padj=-1.2)
    title(main="Mountain Creek: Simulated Flow Percentile Distributions",outer=TRUE,cex=1.6)
    par(mai=c(0.8976/10,0.05,0.7216/4,0.05))
  boxplot(cbind(calib.95th.percentiles[,3],valid.95th.percentiles[,3]),ylim=c(ymin.95,ymax.95),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    title("NSE")
    lines(c(0.5,1.5),c(calib.mc.obs.95,calib.mc.obs.95),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.95,valid.mc.obs.95),col="red",lwd=3,lend=1)
    points(1,calib.mc.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcNS1_C[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcNS1_V[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
  boxplot(cbind(calib.95th.percentiles[,5],valid.95th.percentiles[,5]),ylim=c(ymin.95,ymax.95),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    title("MNS")
    lines(c(0.5,1.5),c(calib.mc.obs.95,calib.mc.obs.95),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.95,valid.mc.obs.95),col="red",lwd=3,lend=1)  
    points(1,calib.mc.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcMNS_C[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcMNS_V[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
  boxplot(cbind(calib.95th.percentiles[,7],valid.95th.percentiles[,7]),ylim=c(ymin.95,ymax.95),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    title("RSD")
    lines(c(0.5,1.5),c(calib.mc.obs.95,calib.mc.obs.95),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.95,valid.mc.obs.95),col="red",lwd=3,lend=1)
    points(1,calib.mc.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.95,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcRSD_C[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcRSD_V[1],col="darkgreen",pch=4,cex=1.8,lwd=2)
  par(mai=c(0.8976/10,0.05,0.7216/10,0.05))
  ymax.50 <- max(calib.50th.percentiles[,1],valid.50th.percentiles[,1],calib.50th.percentiles[,3],valid.50th.percentiles[,3],
                 calib.50th.percentiles[,5],valid.50th.percentiles[,5],calib.50th.percentiles[,7],valid.50th.percentiles[,7])
  ymax.50 <- 0.06 #artificially lowered
  ymin.50 <- min(calib.50th.percentiles[,1],valid.50th.percentiles[,1],calib.50th.percentiles[,3],valid.50th.percentiles[,3],
                 calib.50th.percentiles[,5],valid.50th.percentiles[,5],calib.50th.percentiles[,7],valid.50th.percentiles[,7])
  boxplot(cbind(calib.50th.percentiles[,1],valid.50th.percentiles[,1]),ylim=c(ymin.50,ymax.50),ylab="50th Percentiles",xaxt="n",col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.mc.obs.50,calib.mc.obs.50),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.50,valid.mc.obs.50),col="red",lwd=3,lend=1)
    points(1,calib.mc.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcCL_C[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcCL_V[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    axis(2,at=0.032,labels="50th Percentiles",outer=TRUE,padj=-1.2)
    par(mai=c(0.8976/10,0.05,0.7216/10,0.05))
  boxplot(cbind(calib.50th.percentiles[,3],valid.50th.percentiles[,3]),ylim=c(ymin.50,ymax.50),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.mc.obs.50,calib.mc.obs.50),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.50,valid.mc.obs.50),col="red",lwd=3,lend=1)
    points(1,calib.mc.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcNS1_C[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcNS1_V[2],col="darkgreen",pch=4,cex=1.8,lwd=2) #doesn't plot
    points(2,0.06,col="darkgreen",pch=8,cex=1.8,lwd=2)
    text(1.6,0.06,labels="0.15")
  boxplot(cbind(calib.50th.percentiles[,5],valid.50th.percentiles[,5]),ylim=c(ymin.50,ymax.50),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.mc.obs.50,calib.mc.obs.50),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.50,valid.mc.obs.50),col="red",lwd=3,lend=1)  
    points(1,calib.mc.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcMNS_C[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcMNS_V[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
  boxplot(cbind(calib.50th.percentiles[,7],valid.50th.percentiles[,7]),ylim=c(ymin.50,ymax.50),yaxt="n",xaxt="n",col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.mc.obs.50,calib.mc.obs.50),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.50,valid.mc.obs.50),col="red",lwd=3,lend=1)
    points(1,calib.mc.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.50,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcRSD_C[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcRSD_V[2],col="darkgreen",pch=4,cex=1.8,lwd=2)
  par(mai=c(0.8976/3,0.05,0.7216/10,0.05))
  ymax.5 <- max(calib.5th.percentiles[,1],valid.5th.percentiles[,1],calib.5th.percentiles[,3],valid.5th.percentiles[,3],
                 calib.5th.percentiles[,5],valid.5th.percentiles[,5],calib.5th.percentiles[,7],valid.5th.percentiles[,7])
  ymax.5 <- 0.0046 #artificially lowered
  ymin.5 <- min(calib.5th.percentiles[,1],valid.5th.percentiles[,1],calib.5th.percentiles[,3],valid.5th.percentiles[,3],
                 calib.5th.percentiles[,5],valid.5th.percentiles[,5],calib.5th.percentiles[,7],valid.5th.percentiles[,7])
  boxplot(cbind(calib.5th.percentiles[,1],valid.5th.percentiles[,1]),ylim=c(ymin.5,ymax.5),ylab="5th Percentiles",names=c("C","V"),col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.mc.obs.5,calib.mc.obs.5),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.5,valid.mc.obs.5),col="red",lwd=3,lend=1)  
    points(1,calib.mc.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcCL_C[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcCL_V[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    axis(2,at=0.0023,labels="5th Percentiles",outer=TRUE,padj=-1.2)
    par(mai=c(0.8976/3,0.05,0.7216/10,0.05))
  boxplot(cbind(calib.5th.percentiles[,3],valid.5th.percentiles[,3]),ylim=c(ymin.5,ymax.5),yaxt="n",names=c("C","V"),col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.mc.obs.5,calib.mc.obs.5),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.5,valid.mc.obs.5),col="red",lwd=3,lend=1)
    points(1,calib.mc.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcNS1_C[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcNS1_V[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
  boxplot(cbind(calib.5th.percentiles[,5],valid.5th.percentiles[,5]),ylim=c(ymin.5,ymax.5),yaxt="n",names=c("C","V"),col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.mc.obs.5,calib.mc.obs.5),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.5,valid.mc.obs.5),col="red",lwd=3,lend=1)
    points(1,calib.mc.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcMNS_C[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcMNS_V[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    legend(.425,0.0048,c("Observed","Best Run"),pch=c(1,4),col=c("red","darkgreen"),lty=c(1,0),lwd=c(2,2),cex=1.1,border="white")
  boxplot(cbind(calib.5th.percentiles[,7],valid.5th.percentiles[,7]),ylim=c(ymin.5,ymax.5),yaxt="n",names=c("C","V"),col=c("gold","steelblue3"))
    lines(c(0.5,1.5),c(calib.mc.obs.5,calib.mc.obs.5),col="red",lwd=3,lend=2)
    lines(c(1.5,2.5),c(valid.mc.obs.5,valid.mc.obs.5),col="red",lwd=3,lend=1)
    points(1,calib.mc.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(2,valid.mc.obs.5,col="red",pch=1,cex=1.8,lwd=2)
    points(1,fdc.values$mcRSD_C[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
    points(2,fdc.values$mcRSD_V[3],col="darkgreen",pch=4,cex=1.8,lwd=2)
dev.off()
